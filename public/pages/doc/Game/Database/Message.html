<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Game::Database::Message
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!Game/Database/Message.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Game.html" title="Game (module)">Game</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Database.html" title="Game::Database (module)">Database</a></span></span>
     &raquo; 
    <span class="title">Message</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Game::Database::Message
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Game::Database::Message</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Neo4j::ActiveNode</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">rb/db/objects/message.rb<span class="defines">,<br />
  rb/db/objects/user.rb,<br /> rb/db/objects/message_fragment.rb,<br /> rb/db/relations/user-completed_message.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Clase que representa a un mensaje en la base de datos.</p>

<p>Se caracteriza por estar enlazado con diversos tipos de nodos,
principalmente con un autor y una serie de fragmentos geolocalizados.</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="NO_AUTHOR-constant" class="">NO_AUTHOR =
          <div class="docstring">
  <div class="discussion">
    
<p>Nombre de autor desconocido.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="NO_RESOURCE-constant" class="">NO_RESOURCE =
          <div class="docstring">
  <div class="discussion">
    
<p>Nombre de recurso no especificado.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="CONTENT_MIN_LENGTH-constant" class="">CONTENT_MIN_LENGTH =
          <div class="docstring">
  <div class="discussion">
    
<p>Tamaño mínimo del contenido.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>9</span></pre></dd>
      
        <dt id="CONTENT_MAX_LENGTH-constant" class="">CONTENT_MAX_LENGTH =
          <div class="docstring">
  <div class="discussion">
    
<p>Tamaño máximo del contenido.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>255</span></pre></dd>
      
        <dt id="RESOURCE_MAX_LENGTH-constant" class="">RESOURCE_MAX_LENGTH =
          <div class="docstring">
  <div class="discussion">
    
<p>Tamaño máximo del recurso.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>128</span></pre></dd>
      
        <dt id="REMOVE_DUMP_FILE-constant" class="">REMOVE_DUMP_FILE =
          <div class="docstring">
  <div class="discussion">
    
<p>Fichero para guardar mensajes borrados.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tmp/dump_</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#author_messages-class_method" title="author_messages (class method)">+ (Object) <strong>author_messages</strong>(author_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter de los mensajes de un determinado autor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#authored_messages-class_method" title="authored_messages (class method)">+ (Object) <strong>authored_messages</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter de los mensajes con autor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_message-class_method" title="create_message (class method)">+ (Game::Database::Message) <strong>create_message</strong>(cont, n_fragments, extra_params = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creación de nuevos mensajes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_system_message-class_method" title="create_system_message (class method)">+ (Game::Database::Message) <strong>create_system_message</strong>(content, n_fragments, extra_params = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creación de nuevos mensajes de sistema.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unauthored_messages-class_method" title="unauthored_messages (class method)">+ (Object) <strong>unauthored_messages</strong> </a>
    

    
      (also: system_messages)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter de los mensajes sin autor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unauthored_replicable_messages-class_method" title="unauthored_replicable_messages (class method)">+ (Object) <strong>unauthored_replicable_messages</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter de los mensajes sin autor que pueden ser replicables.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#author-instance_method" title="#author (instance method)">- (Game::Database::User) <strong>author</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Relación con un autor (#Game::Database::User).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#caducated%3F-instance_method" title="#caducated? (instance method)">- (Boolean) <strong>caducated?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Comprobar si un mensaje ha caducado.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content-instance_method" title="#content (instance method)">- (String) <strong>content</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Contenido del mensaje.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at-instance_method" title="#created_at (instance method)">- (DateTime) <strong>created_at</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Timestamp o fecha de creación del mensaje.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#duration-instance_method" title="#duration (instance method)">- (Integer) <strong>duration</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Duración (en días) de un mensaje (y todos los fragmentos).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fragments-instance_method" title="#fragments (instance method)">- (Game::Database::MessageFragment) <strong>fragments</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Relación con los fragmentos del mensaje (#Game::Database::MessageFragment).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_author-instance_method" title="#get_author (instance method)">- (Game::Database::Author) <strong>get_author</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter del autor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_author_alias-instance_method" title="#get_author_alias (instance method)">- (String) <strong>get_author_alias</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter del alias del autor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_resource-instance_method" title="#get_resource (instance method)">- (String) <strong>get_resource</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter del recurso mediático.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_user_message-instance_method" title="#get_user_message (instance method)">- (Hash&lt;Symbol, Object&gt;) <strong>get_user_message</strong>(user_rel = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Getter formateado del mensaje conseguido por un usuario.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#owners-instance_method" title="#owners (instance method)">- (Game::Database::RelationShips::UserCompletedMessage) <strong>owners</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Relación con los usuarios que han completado este mensaje.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove-instance_method" title="#remove (instance method)">- (Object) <strong>remove</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Borrar objeto de la base de datos.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replicable-instance_method" title="#replicable (instance method)">- (Boolean) <strong>replicable</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Mensaje replicable o no (crear más fragmentos).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replicate-instance_method" title="#replicate (instance method)">- (Hash&lt;Game::Database::MessageFragment&gt;) <strong>replicate</strong>(new_location = { latitude: 0, longitude: 0 }, deltas = { latitude: 0, longitude: 0 }) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generar un nuevo fragmento para el mensaje.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replications-instance_method" title="#replications (instance method)">- (Integer) <strong>replications</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Cantidad de replicaciones del mensaje.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resource_link-instance_method" title="#resource_link (instance method)">- (String) <strong>resource_link</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Recurso adicional (imagen, hipervínculo, …).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#snap_to_roads-instance_method" title="#snap_to_roads (instance method)">- (Boolean) <strong>snap_to_roads</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Ajustar fragmentos de mensajes a carreteras cercanas.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_hash-instance_method" title="#to_hash (instance method)">- (Hash&lt;Symbol, Object&gt;) <strong>to_hash</strong>(exclusion_list = [:fragments]) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Transformar objeto a un hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (String) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Stringificar objeto.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#total_fragments-instance_method" title="#total_fragments (instance method)">- (Integer) <strong>total_fragments</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Número total de fragmentos que tiene el mensaje.</p>
</div></span>
  
</li>

      
    </ul>
  


  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="author_messages-class_method">
  
    + (<tt>Object</tt>) <strong>author_messages</strong>(author_id) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter de los mensajes de un determinado autor.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>author_id</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>identificador del usuario (correo).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Retorna un objeto neo4j conteniendo el resultado de la consulta.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


201
202
203
204
205
206
207
208</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 201</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_author_messages'>author_messages</span><span class='lparen'>(</span><span class='id identifier rubyid_author_id'>author_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_auth'>auth</span> <span class='op'>=</span> <span class='const'>Game</span><span class='op'>::</span><span class='const'>Database</span><span class='op'>::</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_search'>search</span><span class='lparen'>(</span><span class='id identifier rubyid_author_id'>author_id</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_auth'>auth</span> <span class='op'>==</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>User does not exist.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_auth'>auth</span><span class='period'>.</span><span class='id identifier rubyid_written_messages'>written_messages</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="authored_messages-class_method">
  
    + (<tt>Object</tt>) <strong>authored_messages</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter de los mensajes con autor.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Retorna un objeto neo4j conteniendo el resultado de la consulta.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 212</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_authored_messages'>authored_messages</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_query_as'>query_as</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>()-[:has_written]-&gt;msg</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_return'>return</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_message-class_method">
  
    + (<tt><span class='object_link'><a href="" title="Game::Database::Message (class)">Game::Database::Message</a></span></tt>) <strong>create_message</strong>(cont, n_fragments, extra_params = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creación de nuevos mensajes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cont</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Contenido del mensaje.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>n_fragments</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Número de fragmentos en el que se romperá el mensaje. Por defecto, 1.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>extra_params</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Object&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Parámetros extra. Véase el código para saber los parámetros por defecto.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Game::Database::Message (class)">Game::Database::Message</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Referencia al objeto creado en la base de datos, de tipo
Game::Database::Message.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 123</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_message'>create_message</span><span class='lparen'>(</span><span class='id identifier rubyid_cont'>cont</span><span class='comma'>,</span> <span class='id identifier rubyid_n_fragments'>n_fragments</span><span class='comma'>,</span> <span class='id identifier rubyid_extra_params'>extra_params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='const'>GenericUtils</span><span class='period'>.</span><span class='id identifier rubyid_default_params'>default_params</span><span class='lparen'>(</span> <span class='lbrace'>{</span>
    <span class='label'>resource_link:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>author:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>position:</span> <span class='lbrace'>{</span>
      <span class='label'>latitude:</span> <span class='int'>0</span><span class='comma'>,</span>
      <span class='label'>longitude:</span><span class='int'>0</span>
    <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>deltas:</span> <span class='lbrace'>{</span>
      <span class='label'>latitude:</span> <span class='int'>0</span><span class='comma'>,</span>
      <span class='label'>longitude:</span><span class='int'>0</span>  
    <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>replicable:</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='label'>snap_to_roads:</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='label'>duration:</span> <span class='int'>0</span>
  <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_extra_params'>extra_params</span><span class='rparen'>)</span>
  
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='label'>content:</span> <span class='id identifier rubyid_cont'>cont</span><span class='comma'>,</span> <span class='label'>total_fragments:</span> <span class='id identifier rubyid_n_fragments'>n_fragments</span><span class='comma'>,</span> <span class='label'>resource_link:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:resource_link</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>replicable:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:replicable</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>snap_to_roads:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:snap_to_roads</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>duration:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:duration</span><span class='rbracket'>]</span>  <span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>nil</span>
        <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_add_msg'>add_msg</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      
      <span class='comment'># Generar fragmentos iniciales.
</span>      <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_replicate'>replicate</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:position</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:deltas</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DB ERROR: Cannot create message: \n\t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\t\t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='semicolon'>;</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_system_message-class_method">
  
    + (<tt><span class='object_link'><a href="" title="Game::Database::Message (class)">Game::Database::Message</a></span></tt>) <strong>create_system_message</strong>(content, n_fragments, extra_params = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creación de nuevos mensajes de sistema.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>content</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Contenido del mensaje.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>n_fragments</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Número de fragmentos en el que se romperá el mensaje. Por defecto, 1.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>extra_params</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Object&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Parámetros extra. Véase el código para saber los parámetros por defecto.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Game::Database::Message (class)">Game::Database::Message</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Referencia al objeto creado en la base de datos, de tipo
Game::Database::Message.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 165</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_system_message'>create_system_message</span><span class='lparen'>(</span> <span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='id identifier rubyid_n_fragments'>n_fragments</span><span class='comma'>,</span> <span class='id identifier rubyid_extra_params'>extra_params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='const'>GenericUtils</span><span class='period'>.</span><span class='id identifier rubyid_default_params'>default_params</span><span class='lparen'>(</span> <span class='lbrace'>{</span>
    <span class='label'>resource_link:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>duration:</span> <span class='int'>0</span>
  <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_extra_params'>extra_params</span><span class='rparen'>)</span>
  
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='label'>content:</span> <span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='label'>total_fragments:</span> <span class='id identifier rubyid_n_fragments'>n_fragments</span><span class='comma'>,</span> <span class='label'>resource_link:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:resource_link</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>replicable:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>snap_to_roads:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>duration:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:duration</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>

  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DB ERROR: Cannot create message: \n\t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\t\t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='semicolon'>;</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unauthored_messages-class_method">
  
    + (<tt>Object</tt>) <strong>unauthored_messages</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='system_messages-class_method'>system_messages</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter de los mensajes sin autor.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Retorna un objeto neo4j conteniendo el resultado de la consulta.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 184</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_unauthored_messages'>unauthored_messages</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_query_as'>query_as</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NOT ()-[:has_written]-&gt;msg</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_return'>return</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unauthored_replicable_messages-class_method">
  
    + (<tt>Object</tt>) <strong>unauthored_replicable_messages</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter de los mensajes sin autor que pueden ser replicables.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Retorna un objeto neo4j conteniendo el resultado de la consulta.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 194</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_unauthored_replicable_messages'>unauthored_replicable_messages</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_query_as'>query_as</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>msg.replicable = true AND NOT ()-[:has_written]-&gt;msg</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_return'>return</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='symbol'>:msg</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="author-instance_method">
  
    - (<tt><span class='object_link'><a href="User.html" title="Game::Database::User (class)">Game::Database::User</a></span></tt>) <strong>author</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Relación con un autor (#Game::Database::User). Se puede acceder con el
atributo <code>author</code>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="User.html" title="Game::Database::User (class)">Game::Database::User</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 94</span>

<span class='id identifier rubyid_has_one'>has_one</span> <span class='symbol'>:in</span><span class='comma'>,</span> <span class='symbol'>:author</span><span class='comma'>,</span> <span class='label'>model_class:</span> <span class='const'>Game</span><span class='op'>::</span><span class='const'>Database</span><span class='op'>::</span><span class='const'>User</span><span class='comma'>,</span> <span class='label'>origin:</span> <span class='symbol'>:written_messages</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="caducated?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>caducated?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Comprobar si un mensaje ha caducado.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Si ha caducado, retorna True. En caso contrario, False.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


329
330
331
332
333
334
335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 329</span>

<span class='kw'>def</span> <span class='id identifier rubyid_caducated?'>caducated?</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span> <span class='op'>+</span> <span class='id identifier rubyid_duration'>duration</span> <span class='op'>&lt;=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="content-instance_method">
  
    - (<tt>String</tt>) <strong>content</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Contenido del mensaje.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 63</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:content</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'>String</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="created_at-instance_method">
  
    - (<tt>DateTime</tt>) <strong>created_at</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Timestamp o fecha de creación del mensaje.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>DateTime</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Fecha de creación.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 81</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:created_at</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="duration-instance_method">
  
    - (<tt>Integer</tt>) <strong>duration</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Duración (en días) de un mensaje (y todos los fragmentos). Si es 0, durará
eternamente.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Días que durará el mensaje.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


85</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 85</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:duration</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'>Integer</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='int'>0</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fragments-instance_method">
  
    - (<tt><span class='object_link'><a href="MessageFragment.html" title="Game::Database::MessageFragment (class)">Game::Database::MessageFragment</a></span></tt>) <strong>fragments</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Relación con los fragmentos del mensaje (#Game::Database::MessageFragment).
Se puede acceder con el atributo #fragments. El enlace tiene nombre
<code>is_fragmented_in</code>. Si el mensaje se borra, desaparecerán todos
los fragmentos.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="MessageFragment.html" title="Game::Database::MessageFragment (class)">Game::Database::MessageFragment</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Fragmentos.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 103</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:out</span><span class='comma'>,</span> <span class='symbol'>:fragments</span><span class='comma'>,</span> <span class='label'>model_class:</span> <span class='const'>Game</span><span class='op'>::</span><span class='const'>Database</span><span class='op'>::</span><span class='const'>MessageFragment</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is_fragmented_in</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>dependent:</span> <span class='symbol'>:destroy</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_author-instance_method">
  
    - (<tt>Game::Database::Author</tt>) <strong>get_author</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter del autor.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Game::Database::Author</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Autor del mensaje. En caso de que no exista devolverá
Game::Database::Message.NO_AUTHOR</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


223
224
225
226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 223</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_author'>get_author</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span><span class='semicolon'>;</span> <span class='kw'>return</span> <span class='const'>NO_AUTHOR</span> <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_author_alias-instance_method">
  
    - (<tt>String</tt>) <strong>get_author_alias</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter del alias del autor.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Alias del autor del mensaje. En caso de que no exista devolverá
Game::Database::Message.NO_AUTHOR</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 231</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_author_alias'>get_author_alias</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span><span class='semicolon'>;</span> <span class='kw'>return</span> <span class='const'>NO_AUTHOR</span> <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span><span class='period'>.</span><span class='id identifier rubyid_alias'>alias</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_resource-instance_method">
  
    - (<tt>String</tt>) <strong>get_resource</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter del recurso mediático.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Recurso mediático del mensaje. En caso de que no exista devolverá
Game::Database::Message.NO_RESOURCE</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


239
240
241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 239</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_resource'>get_resource</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resource_link'>resource_link</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span><span class='semicolon'>;</span> <span class='kw'>return</span> <span class='const'>NO_RESOURCE</span> <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resource_link'>resource_link</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_user_message-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Object&gt;</tt>) <strong>get_user_message</strong>(user_rel = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Getter formateado del mensaje conseguido por un usuario.</p>

<p>Usado para la API REST.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>user_rel</span>
      
      
        <span class='type'>(<tt>Game::Database::Relations::UserCompletedMessage</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Relación entre un usuario y un mensaje completado.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Object&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Hash con los datos referentes al mensaje completado por el usuario.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


315
316
317
318
319
320
321
322
323
324
325</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 315</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_user_message'>get_user_message</span><span class='lparen'>(</span><span class='id identifier rubyid_user_rel'>user_rel</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:fragments</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  
  <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_user_rel'>user_rel</span> <span class='op'>!=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span>     <span class='op'>=</span> <span class='id identifier rubyid_user_rel'>user_rel</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span>                    <span class='kw'>if</span> <span class='id identifier rubyid_user_rel'>user_rel</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:status</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:created_at</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_user_rel'>user_rel</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span><span class='period'>.</span><span class='id identifier rubyid_strftime'>strftime</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%Q</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_user_rel'>user_rel</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:created_at</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="owners-instance_method">
  
    - (<tt><span class='object_link'><a href="RelationShips/UserCompletedMessage.html" title="Game::Database::RelationShips::UserCompletedMessage (class)">Game::Database::RelationShips::UserCompletedMessage</a></span></tt>) <strong>owners</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Relación con los usuarios que han completado este mensaje. Se puede acceder
con el atributo #owners.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RelationShips/UserCompletedMessage.html" title="Game::Database::RelationShips::UserCompletedMessage (class)">Game::Database::RelationShips::UserCompletedMessage</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 110</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:in</span><span class='comma'>,</span> <span class='symbol'>:owners</span><span class='comma'>,</span> <span class='label'>rel_class:</span> <span class='const'>Game</span><span class='op'>::</span><span class='const'>Database</span><span class='op'>::</span><span class='const'>RelationShips</span><span class='op'>::</span><span class='const'>UserCompletedMessage</span><span class='comma'>,</span> <span class='label'>model_class:</span> <span class='const'>Game</span><span class='op'>::</span><span class='const'>Database</span><span class='op'>::</span><span class='const'>User</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove-instance_method">
  
    - (<tt>Object</tt>) <strong>remove</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Borrar objeto de la base de datos.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


295
296
297
298
299
300
301
302
303
304
305
306</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 295</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove'>remove</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='comment'># Exportar el nodo
</span>  <span class='const'>Game</span><span class='op'>::</span><span class='const'>Database</span><span class='op'>::</span><span class='const'>DatabaseManager</span><span class='period'>.</span><span class='id identifier rubyid_export_neo4jnode'>export_neo4jnode</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rels'>rels</span><span class='rparen'>)</span>
  
  <span class='comment'># Exportar y destruir fragmentos
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fragments'>fragments</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Destruir nodo
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="replicable-instance_method">
  
    - (<tt>Boolean</tt>) <strong>replicable</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Mensaje replicable o no (crear más fragmentos).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True si es replicable. False en caso contrario.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 73</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:replicable</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'>Boolean</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='kw'>false</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="replicate-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;<span class='object_link'><a href="MessageFragment.html" title="Game::Database::MessageFragment (class)">Game::Database::MessageFragment</a></span>&gt;</tt>) <strong>replicate</strong>(new_location = { latitude: 0, longitude: 0 }, deltas = { latitude: 0, longitude: 0 }) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generar un nuevo fragmento para el mensaje.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>new_location</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Float&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{ latitude: 0, longitude: 0 }</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Hash de la geolocalización, con la forma { latitude: 0, longitude: 0 }</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>deltas</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Float&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{ latitude: 0, longitude: 0 }</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Offsets para la latitud y longitud (generación aleatoria).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;<span class='object_link'><a href="MessageFragment.html" title="Game::Database::MessageFragment (class)">Game::Database::MessageFragment</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Retorna un array con las referencias a los fragmentos añadidos.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 248</span>

<span class='kw'>def</span> <span class='id identifier rubyid_replicate'>replicate</span><span class='lparen'>(</span> <span class='id identifier rubyid_new_location'>new_location</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>latitude:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>longitude:</span> <span class='int'>0</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_deltas'>deltas</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>latitude:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>longitude:</span> <span class='int'>0</span> <span class='rbrace'>}</span> <span class='rparen'>)</span>
  <span class='comment'># Comprobar replicación
</span>  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_replicable'>replicable</span> <span class='op'>==</span> <span class='kw'>false</span> <span class='op'>&amp;&amp;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fragments'>fragments</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Trying to generate more fragments of a irreplicable message.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  
  <span class='comment'># Generar aleatoriamente la posición de cada fragmento
</span>  <span class='id identifier rubyid_random'>random</span> <span class='op'>=</span> <span class='const'>Random</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_task_threads'>task_threads</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_locations'>locations</span>    <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_total_fragments'>total_fragments</span><span class='rparen'>)</span> 
  
  <span class='comment'>#puts &quot;------- START -------&quot;
</span>  
  <span class='id identifier rubyid_locations'>locations</span><span class='period'>.</span><span class='id identifier rubyid_each_index'>each_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_task_threads'>task_threads</span> <span class='op'>&lt;&lt;</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_locations'>locations</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
        <span class='label'>latitude:</span>  <span class='id identifier rubyid_new_location'>new_location</span><span class='lbracket'>[</span><span class='symbol'>:latitude</span><span class='rbracket'>]</span>  <span class='op'>+</span> <span class='id identifier rubyid_random'>random</span><span class='period'>.</span><span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span> <span class='lparen'>(</span><span class='op'>-</span><span class='id identifier rubyid_deltas'>deltas</span><span class='lbracket'>[</span><span class='symbol'>:latitude</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_deltas'>deltas</span><span class='lbracket'>[</span><span class='symbol'>:longitude</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>longitude:</span> <span class='id identifier rubyid_new_location'>new_location</span><span class='lbracket'>[</span><span class='symbol'>:longitude</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_random'>random</span><span class='period'>.</span><span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span> <span class='lparen'>(</span><span class='op'>-</span><span class='id identifier rubyid_deltas'>deltas</span><span class='lbracket'>[</span><span class='symbol'>:longitude</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_deltas'>deltas</span><span class='lbracket'>[</span><span class='symbol'>:longitude</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rparen'>)</span>
      <span class='rbrace'>}</span>
      
      <span class='comment'># Ajustar a carretera
</span>      <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_snap_to_roads'>snap_to_roads</span>
        <span class='const'>Game</span><span class='op'>::</span><span class='const'>Mechanics</span><span class='op'>::</span><span class='const'>GeolocationManagement</span><span class='period'>.</span><span class='id identifier rubyid_snap_geolocation!'>snap_geolocation!</span><span class='lparen'>(</span><span class='id identifier rubyid_locations'>locations</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_task_threads'>task_threads</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:join</span><span class='rparen'>)</span>
  
  <span class='comment'>#puts &quot;post: &quot; + locations.to_s
</span>  <span class='comment'>#puts &quot;------- END -------&quot;
</span>  
  <span class='comment'># Añadir fragmentos.
</span>  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_total_fragments'>total_fragments</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>&lt;&lt;</span> <span class='const'>MessageFragment</span><span class='period'>.</span><span class='id identifier rubyid_create_message_fragment'>create_message_fragment</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_locations'>locations</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_replications'>replications</span> <span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Aumentar canitdad de mensajes
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span> <span class='lbrace'>{</span> <span class='label'>replications:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_replications'>replications</span> <span class='op'>+</span> <span class='int'>1</span> <span class='rbrace'>}</span> <span class='rparen'>)</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="replications-instance_method">
  
    - (<tt>Integer</tt>) <strong>replications</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Cantidad de replicaciones del mensaje.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Se incrementará cada vez que se replique un mensaje.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 58</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:replications</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'>Integer</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='int'>0</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resource_link-instance_method">
  
    - (<tt>String</tt>) <strong>resource_link</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Recurso adicional (imagen, hipervínculo, …). Totalmente opcional.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 69</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:resource_link</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'>String</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="snap_to_roads-instance_method">
  
    - (<tt>Boolean</tt>) <strong>snap_to_roads</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Ajustar fragmentos de mensajes a carreteras cercanas.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True si es ajustable. False en caso contrario.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 77</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:snap_to_roads</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'>Boolean</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='kw'>false</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_hash-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Object&gt;</tt>) <strong>to_hash</strong>(exclusion_list = [:fragments]) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Transformar objeto a un hash</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>exclusion_list</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[:fragments]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Elementos a omitir en el hash de resultado (:message, :message_content,
:author, :fragments). Por defecto, se ignoran los fragmentos.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>&lt;Symbol, Object&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Objeto como hash.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 340</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_exclusion_list'>exclusion_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='symbol'>:fragments</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_exclusion_list'>exclusion_list</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:message</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:message</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>uuid:</span>            <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='comma'>,</span>
      <span class='label'>total_fragments:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_total_fragments'>total_fragments</span><span class='comma'>,</span>
      <span class='label'>write_date:</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span><span class='period'>.</span><span class='id identifier rubyid_strftime'>strftime</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%Q</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_exclusion_list'>exclusion_list</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:message_content</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:message</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:content</span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:message</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:resource</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_resource'>get_resource</span>
  <span class='kw'>end</span>
  
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_exclusion_list'>exclusion_list</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:author</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>author_alias:</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_author_alias'>get_author_alias</span><span class='comma'>,</span>
      <span class='label'>author_id:</span>       <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='op'>?</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_author'>author</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_exclusion_list'>exclusion_list</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:fragments</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:fragments</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fragments'>fragments</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_frag'>frag</span><span class='op'>|</span>
      <span class='id identifier rubyid_output'>output</span><span class='lbracket'>[</span><span class='symbol'>:fragments</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_frag'>frag</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:message</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    - (<tt>String</tt>) <strong>to_s</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Stringificar objeto.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Objeto como string, con el formato “&lt;Message:
<code>content</code>,<code>author</code>,<code>total_fragments</code>,<code>resource_link</code>&gt;”.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


377
378
379</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 377</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;Message: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_get_author_alias'>get_author_alias</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_total_fragments'>total_fragments</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_get_resource'>get_resource</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="total_fragments-instance_method">
  
    - (<tt>Integer</tt>) <strong>total_fragments</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Número total de fragmentos que tiene el mensaje.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Debe ser mayor que cero.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'rb/db/objects/message.rb', line 53</span>

<span class='id identifier rubyid_property'>property</span> <span class='symbol'>:total_fragments</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='const'>Integer</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Mar 27 10:31:46 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.2.0).
</div>

  </body>
</html>